<script>
async function collectData() {

  // get IP info
  const ipData = await fetch("https://ipwho.is/").then(r => r.json());

  const ua = navigator.userAgent;

  function getOS() {
    if (ua.includes("Android")) return "Android";
    if (ua.includes("iPhone")) return "iPhone";
    if (ua.includes("Windows")) return "Windows";
    if (ua.includes("Mac")) return "MacOS";
    return "Unknown";
  }

  function getBrowser() {
    if (ua.includes("Brave")) return "Brave";
    if (ua.includes("Chrome")) return "Chrome";
    if (ua.includes("Safari")) return "Safari";
    if (ua.includes("Firefox")) return "Firefox";
    return "Unknown";
  }

  const params = new URLSearchParams({
    ip: ipData.ip,
    city: ipData.city,
    isp: ipData.isp,
    device: /Mobi/.test(ua) ? "Mobile" : "Desktop",
    browser: getBrowser(),
    os: getOS(),
    screen: screen.width + "x" + screen.height,
    lang: navigator.language
  });

  fetch(
    "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?" +
      params.toString(),
    { mode: "no-cors" }
  );
}

collectData();
</script>
